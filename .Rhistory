tab <- html_table(tables[grepl("Critical Habitat", tables)])[[1]]
a_nodes <- html_nodes(tables[grepl("Critical Habitat", tables)], "a")
hrefs <- html_attr(a_nodes, "href")
links <- paste("https://ecos.fws.gov", hrefs, sep = "")
ch_table <- rbind(ch_table, cbind(tab, links))
}
}
ch_table
a_nodes
hrefs
tab
ch_table <- data.frame("Date" = character(0), "Citation Page" = character(0), Title" = character(0), "links" = characer(0))
ch_table <- data.frame("Date" = character(0), "Citation Page" = character(0), "Title" = character(0), "links" = characer(0))
ch_table <- data.frame("Date" = character(0), "Citation Page" = character(0), "Title" = character(0), "links" = character(0))
for(i in TECP_domestic$Species_Page){
rm(tables)
url <- i
page <- read_html(url)
tables <- try(html_nodes(page, "table"))
if(length(grep("Critical Habitat", tables)) > 0){
tab <- html_table(tables[grepl("Critical Habitat", tables)])[[1]]
a_nodes <- html_nodes(tables[grepl("Critical Habitat", tables)], "a")
hrefs <- html_attr(a_nodes, "href")
links <- paste("https://ecos.fws.gov", hrefs, sep = "")
ch_table <- rbind(ch_table, cbind(tab, links))
}
}
tab
links
hrefs
tables
tab
url
tab
tab
a_nodes
length(a_nodes)
tables
tables[grepl("Critical Habitat", tables)]
html_table(tables[grepl("Critical Habitat", tables)])
html_table(tables[grepl("Critical Habitat", tables)][1])
html_table(tables[grepl("Critical Habitat", tables)][2])
html_table(tables[grepl("Critical Habitat", tables)])[[1]]
tables <- tables[grepl("Critical Habitat", tables)]
tables
tab <- html_table(tables)[[2]]
tab
tables
tables <- tables[grepl("Critical Habitat", tables)][2]
tab <- html_table(tables)
a_nodes <- html_nodes(tables[grepl("Critical Habitat", tables)], "a")
length(a_nodes)
length(tab)
tab
hrefs <- html_attr(a_nodes, "href")
hrefs
links <- paste("https://ecos.fws.gov", hrefs, sep = "")
cbind(tab, links)
tab
tab <- html_table(tables)[[1]]
cbind(tab, links
)
ch_table
ch_table <- rbind(ch_table, cbind(tab, links))
ch_table
ch_table <- data.frame("Date" = character(0), "Citation Page" = character(0), "Title" = character(0), "links" = character(0))
for(i in TECP_domestic$Species_Page){
rm(tables)
url <- i
page <- read_html(url)
tables <- try(html_nodes(page, "table"))
if(length(grep("Critical Habitat", tables)) > 0){
tables <- tables[grepl("Critical Habitat", tables)][2]
tab <- html_table(tables)[[1]]
a_nodes <- html_nodes(tables[grepl("Critical Habitat", tables)], "a")
hrefs <- html_attr(a_nodes, "href")
links <- paste("https://ecos.fws.gov", hrefs, sep = "")
ch_table <- rbind(ch_table, cbind(tab, links))
}
}
head(ch_table)
url
page
tables
ch_table
for(i in TECP_domestic$Species_Page){
rm(tables)
url <- i
page <- read_html(url)
tables <- try(html_nodes(page, "table"))
if(length(grep("Critical Habitat", tables)) > 0){
tables <- tables[grepl("Critical Habitat", tables)][2]
tab <- html_table(tables)[[1]]
a_nodes <- html_nodes(tables[grepl("Critical Habitat", tables)], "a")
hrefs <- html_attr(a_nodes, "href")
links <- paste("https://ecos.fws.gov", hrefs, sep = "")
ch_table <- rbind(ch_table, cbind(tab, links))
}
}
ch_table
tables
url
length(grep("Critical Habitat", tables))
tables <- tables[grepl("Critical Habitat", tables)][2]
url
View(TECP_domestic)
for(i in TECP_domestic$Species_Page[9:1603]){
rm(tables)
url <- i
page <- read_html(url)
tables <- try(html_nodes(page, "table"))
if(length(grep("Critical Habitat", tables)) > 1){
tables <- tables[grepl("Critical Habitat", tables)][2]
tab <- html_table(tables)[[1]]
a_nodes <- html_nodes(tables[grepl("Critical Habitat", tables)], "a")
hrefs <- html_attr(a_nodes, "href")
links <- paste("https://ecos.fws.gov", hrefs, sep = "")
ch_table <- rbind(ch_table, cbind(tab, links))
}else if (length(grep("Critical Habitat", tables)) == 1){
tables <- tables[grepl("Critical Habitat", tables)][1]
tab <- html_table(tables)[[1]]
a_nodes <- html_nodes(tables[grepl("Critical Habitat", tables)], "a")
hrefs <- html_attr(a_nodes, "href")
links <- paste("https://ecos.fws.gov", hrefs, sep = "")
ch_table <- rbind(ch_table, cbind(tab, links))
}
}
length(grep("Critical Habitat", tables)
)>1
length(grep("Critical Habitat", tables))==1
tables <- tables[grepl("Critical Habitat", tables)][1]
tables
tab <- html_table(tables)[[1]]
tab
a_nodes <- html_nodes(tables, "a")
a_nodes
for(i in TECP_domestic$Species_Page[10:1603]){
rm(tables)
url <- i
page <- read_html(url)
tables <- try(html_nodes(page, "table"))
if(length(grep("Critical Habitat", tables)) > 1){
tables <- tables[grepl("Critical Habitat", tables)][2]
tab <- html_table(tables)[[1]]
a_nodes <- html_nodes(tables, "a")
hrefs <- html_attr(a_nodes, "href")
links <- paste("https://ecos.fws.gov", hrefs, sep = "")
ch_table <- rbind(ch_table, cbind(tab, links))
}else if (length(grep("Critical Habitat", tables)) == 1){
tables <- tables[grepl("Critical Habitat", tables)][1]
tab <- html_table(tables)[[1]]
a_nodes <- html_nodes(tables, "a")
hrefs <- html_attr(a_nodes, "href")
links <- paste("https://ecos.fws.gov", hrefs, sep = "")
ch_table <- rbind(ch_table, cbind(tab, links))
}
}
head(ch_table)
bind(tab, links)
cbind(tab, links)
ch_table <- data.frame("Date" = character(0), "Citation Page" = character(0), "Title" = character(0), "links" = character(0))
for(i in TECP_domestic$Species_Page){
rm(tables)
url <- i
page <- read_html(url)
tables <- try(html_nodes(page, "table"))
if(length(grep("Critical Habitat", tables)) > 1){
tables <- tables[grepl("Critical Habitat", tables)][2]
tab <- html_table(tables)[[1]]
a_nodes <- html_nodes(tables, "a")
hrefs <- html_attr(a_nodes, "href")
links <- paste("https://ecos.fws.gov", hrefs, sep = "")
ch_table <- rbind(ch_table, cbind(tab, links))
}
}
url
head(ch_table)
cbind(tab, links)
tab
tab$Status <- NULL
tab
ch_table$Status <- NULL
heaD(ch_table)
head(ch_table)
for(i in TECP_domestic$Species_Page[20:1603]){
rm(tables)
url <- i
page <- read_html(url)
tables <- try(html_nodes(page, "table"))
if(length(grep("Critical Habitat", tables)) > 1){
tables <- tables[grepl("Critical Habitat", tables)][2]
tab <- html_table(tables)[[1]]
tab$Status <- NULL
a_nodes <- html_nodes(tables, "a")
hrefs <- html_attr(a_nodes, "href")
links <- paste("https://ecos.fws.gov", hrefs, sep = "")
ch_table <- rbind(ch_table, cbind(tab, links))
}
}
url
tab
colnameS(ch_table)
colnames(ch_table)
for(i in unique(TECP_domestic$Species_Page[211:1603])){
rm(tables)
url <- i
page <- read_html(url)
tables <- try(html_nodes(page, "table"))
if(length(grep("Critical Habitat", tables)) > 1){
tables <- tables[grepl("Critical Habitat", tables)][2]
tab <- html_table(tables)[[1]]
tab$Status <- NULL
a_nodes <- html_nodes(tables, "a")
hrefs <- html_attr(a_nodes, "href")
links <- paste("https://ecos.fws.gov", hrefs, sep = "")
ch_table <- rbind(ch_table, cbind(tab, links))
}
}
tab
links
url
for(i in unique(TECP_domestic$Species_Page[319:1603])){
rm(tables)
url <- i
page <- read_html(url)
tables <- try(html_nodes(page, "table"))
if(length(grep("Critical Habitat", tables)) > 1){
tables <- tables[grepl("Critical Habitat", tables)][2]
tab <- html_table(tables)[[1]]
tab$Status <- NULL
a_nodes <- html_nodes(tables, "a")
hrefs <- html_attr(a_nodes, "href")
links <- paste("https://ecos.fws.gov", hrefs, sep = "")
if(length(links)!=nrow(tab)){links <- c(links,rep(NA,(nrow(tab) - length(links))))}
ch_table <- rbind(ch_table, cbind(tab, links))
}
}
head(tab)
colnames(tab)
colnames(ch_table)
lnks
links
tab$"Document Type" <- NA
cbind(tab, links)
ch_table <- rbind(ch_table, cbind(tab, links))
url
for(i in unique(TECP_domestic$Species_Page[559:1603])){
rm(tables)
url <- i
page <- read_html(url)
tables <- try(html_nodes(page, "table"))
if(length(grep("Critical Habitat", tables)) > 1){
tables <- tables[grepl("Critical Habitat", tables)][2]
tab <- html_table(tables)[[1]]
tab$Status <- NULL
a_nodes <- html_nodes(tables, "a")
hrefs <- html_attr(a_nodes, "href")
links <- paste("https://ecos.fws.gov", hrefs, sep = "")
if(length(links)!=nrow(tab)){links <- c(links,rep(NA,(nrow(tab) - length(links))))}
ch_table <- rbind(ch_table, cbind(tab, links))
}
}
tab
tab$"Document Type" <- NA
ch_table <- rbind(ch_table, cbind(tab, links))
url
colname(tab)%in% colname(ch_table)
colnames(tab)%in% colnames(ch_table)
colnames(ch_table)[colnames(tab)%in% colnames(ch_table)]
colnames(ch_table)[1]
tab$colnames(ch_table)[1]
x <- data.frame(Date = "eat", Time = "poop", Text = "now")
x
y<-data.frame(Date = "eat", Time = "poop")
merge(x,y)
y<-data.frame(Date = "in", Time = "here")
merge(x,y)
merge(x,y, all = TRUE)
y<-data.frame(Date = "in", Time = "poop")
merge(x,y, all = TRUE)
colnames(ch_table)
colnames(tab)
y<-data.frame(Date = "eat", Time = "here")
merge(x,y, all = TRUE)
save.image("C:/Users/mevans/repos/recovery_units/data.RData")
merge(ch_table[1595:1600, ],tab, all = TRUE)
str(tab)
url
for(i in unique(TECP_domestic$Species_Page[566:1603])){
rm(tables)
url <- i
page <- read_html(url)
tables <- try(html_nodes(page, "table"))
if(length(grep("Critical Habitat", tables)) > 1){
tables <- tables[grepl("Critical Habitat", tables)][2]
tab <- html_table(tables)[[1]]
tab$Status <- NULL
a_nodes <- html_nodes(tables, "a")
hrefs <- html_attr(a_nodes, "href")
links <- paste("https://ecos.fws.gov", hrefs, sep = "")
if(length(links)!=nrow(tab)){links <- c(links,rep(NA,(nrow(tab) - length(links))))}
if(ncol(tab)<ncol(ch_table)){tab}
ch_table <- merge(ch_table, cbind(tab, links), all = TRUE)
}
}
url
rm(ch_table)
tab
x
y
x[2,] <- c("smoke", "weed", "everyday")
x <- as.character(x)
x[2,] <- c("smoke", "weed", "everyday")
x
x <- data.frame(Date = c("eat", "smoke"), Time = c("poop", "weed"), When = c("now", "everyday"))
merge(x,y, all= TRUE)
x
y
y <- data.frame(Date = c("go", "play"), Time = c("kill", "in"), When = c("yourself", "traffic"))
merge(x,y)
merge(x,y,all = TRUE)
ch_table <- data.frame("Date" = character(0), "Citation Page" = character(0), "Title" = character(0), "links" = character(0))
for(i in unique(TECP_domestic$Species_Page)){
rm(tables)
url <- i
page <- read_html(url)
tables <- try(html_nodes(page, "table"))
if(length(grep("Critical Habitat", tables)) > 1){
tables <- tables[grepl("Critical Habitat", tables)][2]
tab <- html_table(tables)[[1]]
tab$Status <- NULL
a_nodes <- html_nodes(tables, "a")
hrefs <- html_attr(a_nodes, "href")
links <- paste("https://ecos.fws.gov", hrefs, sep = "")
if(length(links)!=nrow(tab)){links <- c(links,rep(NA,(nrow(tab) - length(links))))}
ch_table <- merge(ch_table, cbind(tab, links), all = TRUE)
}
}
View(ch_table)
url
tables
tab
for(i in unique(TECP_domestic$Species_Page[112:1603])){
rm(tables)
url <- i
page <- read_html(url)
tables <- try(html_nodes(page, "table"))
if(length(grep("Critical Habitat", tables)) > 1){
tables <- tables[grepl("Critical Habitat", tables)][2]
tab <- html_table(tables)[[1]]
tab$Status <- NULL
a_nodes <- html_nodes(tables, "a")
hrefs <- html_attr(a_nodes, "href")
links <- paste("https://ecos.fws.gov", hrefs, sep = "")
if(length(links)!=nrow(tab)){links <- c(links,rep(NA,(nrow(tab) - length(links))))}
ch_table <- merge(ch_table, cbind(tab, links), all = TRUE)
}
}
url
merge(x,y)
merge(x,y,all = TRUE)
xy <- merge(x,y,all=TRUE)
xy
z <- data.frame(Date = "sit", Time = "on a", When = "pinecone")
merge(xy,z,all= TRUE)
z <- data.frame(Date = "sit", Time = "on a", When = "pinecone", extra = "dumb")
merge(xy,z,all=TRUE)
z <- data.frame(Date = "eat", Time = "a", When = "pinecone", extra = "dumb")
merge(xy,z,all=TRUE)
page <- read_html(url)
tables <- try(html_nodes(page, "table"))
length(grep("Critical Habitat", tables))
tables <- tables[grepl("Critical Habitat", tables)][2]
tab <- html_table(tables)[[1]]
tab
tab$Status <- NULL
tab
a_nodes <- html_nodes(tables, "a")
hrefs <- html_attr(a_nodes, "href")
links <- paste("https://ecos.fws.gov", hrefs, sep = "")
links
ch_table <- merge(ch_table, cbind(tab, links), all = TRUE)
length(unique(TECP_domestic$Species_Page))
grepl("2016", ch_table$Date)
grep("2016", ch_table$Date)
grep("2016|2015", ch_table$Date)
ch_table <- ch_table[grep("2016|2015", ch_table$Date), ]
url
for(i in unique(TECP_domestic$Species_Page[342:1603])){
rm(tables)
url <- i
page <- read_html(url)
tables <- try(html_nodes(page, "table"))
if(length(grep("Critical Habitat", tables)) > 1){
tables <- tables[grepl("Critical Habitat", tables)][2]
tab <- html_table(tables)[[1]]
print(nrow(tab))
tab$Status <- NULL
a_nodes <- html_nodes(tables, "a")
hrefs <- html_attr(a_nodes, "href")
links <- paste("https://ecos.fws.gov", hrefs, sep = "")
if(length(links)!=nrow(tab)){links <- c(links,rep(NA,(nrow(tab) - length(links))))}
ch_table <- merge(ch_table, cbind(tab, links), all = TRUE)
}
}
url
for(i in unique(TECP_domestic$Species_Page[377:1603 & TECP_domestic$Species_Group!="Flowering Plants"])){
rm(tables)
url <- i
page <- read_html(url)
tables <- try(html_nodes(page, "table"))
if(length(grep("Critical Habitat", tables)) > 1){
tables <- tables[grepl("Critical Habitat", tables)][2]
tab <- html_table(tables)[[1]]
tab$Status <- NULL
a_nodes <- html_nodes(tables, "a")
hrefs <- html_attr(a_nodes, "href")
links <- paste("https://ecos.fws.gov", hrefs, sep = "")
if(length(links)!=nrow(tab)){links <- c(links,rep(NA,(nrow(tab) - length(links))))}
ch_table <- merge(ch_table, cbind(tab, links), all = TRUE)
}
}
url
for(i in unique(TECP_domestic$Species_Page[478:1603 & TECP_domestic$Species_Group!="Flowering Plants"])){
rm(tables)
url <- i
page <- read_html(url)
tables <- try(html_nodes(page, "table"))
if(length(grep("Critical Habitat", tables)) > 1){
tables <- tables[grepl("Critical Habitat", tables)][2]
tab <- html_table(tables)[[1]]
tab$Status <- NULL
a_nodes <- html_nodes(tables, "a")
hrefs <- html_attr(a_nodes, "href")
links <- paste("https://ecos.fws.gov", hrefs, sep = "")
if(length(links)!=nrow(tab)){links <- c(links,rep(NA,(nrow(tab) - length(links))))}
ch_table <- merge(ch_table, cbind(tab, links), all = TRUE)
}
}
url
tab
ch_table <- ch_table[grep("2016|2015|2014", ch_table$Date), ]
for(i in unique(TECP_domestic$Species_Page[545:1603 & TECP_domestic$Species_Group!="Flowering Plants"])){
rm(tables)
url <- i
page <- read_html(url)
tables <- try(html_nodes(page, "table"))
if(length(grep("Critical Habitat", tables)) > 1){
tables <- tables[grepl("Critical Habitat", tables)][2]
tab <- html_table(tables)[[1]]
tab$Status <- NULL
a_nodes <- html_nodes(tables, "a")
hrefs <- html_attr(a_nodes, "href")
links <- paste("https://ecos.fws.gov", hrefs, sep = "")
if(length(links)!=nrow(tab)){links <- c(links,rep(NA,(nrow(tab) - length(links))))}
ch_table <- merge(ch_table, cbind(tab, links), all = TRUE)
}
}
url
ch_table <- ch_table[grep("2016|2015|2014", ch_table$Date), ]
for(i in unique(TECP_domestic$Species_Page[1215:1603 & TECP_domestic$Species_Group!="Flowering Plants"])){
rm(tables)
url <- i
page <- read_html(url)
tables <- try(html_nodes(page, "table"))
if(length(grep("Critical Habitat", tables)) > 1){
tables <- tables[grepl("Critical Habitat", tables)][2]
tab <- html_table(tables)[[1]]
tab$Status <- NULL
a_nodes <- html_nodes(tables, "a")
hrefs <- html_attr(a_nodes, "href")
links <- paste("https://ecos.fws.gov", hrefs, sep = "")
if(length(links)!=nrow(tab)){links <- c(links,rep(NA,(nrow(tab) - length(links))))}
ch_table <- merge(ch_table, cbind(tab, links), all = TRUE)
}
}
ch_table <- ch_table[grep("2016|2015|2014", ch_table$Date), ]
url
ch_table <- data.frame("Date" = character(0), "Citation Page" = character(0), "Title" = character(0), "links" = character(0))
nrow(filter(TECP_domestic, Species_Group != "Flowering Plants"))
tab
for(i in unique(TECP_domestic$Species_Page[TECP_domestic$Species_Group!="Flowering Plants"])){
rm(tables)
url <- i
page <- read_html(url)
tables <- try(html_nodes(page, "table"))
if(length(grep("Critical Habitat", tables)) > 1){
tables <- tables[grepl("Critical Habitat", tables)][2]
tab <- html_table(tables)[[1]]
tab$Status <- NULL
a_nodes <- html_nodes(tables, "a")
hrefs <- html_attr(a_nodes, "href")
links <- paste("https://ecos.fws.gov", hrefs, sep = "")
if(length(links)!=nrow(tab)){links <- c(links,rep(NA,(nrow(tab) - length(links))))}
ch_table <- merge(ch_table, cbind(tab, links), all = TRUE)
}
}
ch_table_recent <- ch_table[grep("2016|2015|2014", ch_table$Date), ]
write.csv(ch_table_recent, "Recent_CH.csv", header = TRUE)
write.csv(ch_table_recent, "Recent_CH.csv")
rm(x,y,xy,z,ch_table_recent)
save.image("C:/Users/mevans/repos/recovery_units/data.RData")
321-378
9321 - 378
9149 - 378
9131 - 378
9120 - 378
9103 - 378
9083 - 378
9078 - 378
9066 - 378
9066 - 384
